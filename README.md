This is a clean implementation for net-plumber, intended for further developing.
